#pragma once

/*==============================================================================
Sample pulse generator.
==========================================================================*/

//******************************************************************************
//******************************************************************************
//******************************************************************************

#include "risCmdLineScript.h"

//******************************************************************************
//******************************************************************************
//******************************************************************************
// This class generates synthetic pulses for samples. It writes to a sample
// history csv file. It uses a command line script file to define the pulses.
//

class PulseGen
{
public:

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Members.

   // Command line script file.
   Ris::CmdLineScript mScript;

   // Parameters.
   int mSampleCountMax;

   // Sample time seconds.
   float mSampleTime;

   // Metrics.
   int mSampleCount;

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Constructor.
   PulseGen();
   void resetVars();

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Generate a sample history csv file of pulses based on a command line
   // script file.
   void doGenerate();

   //***************************************************************************
   //***************************************************************************
   //***************************************************************************
   // Methods.

   // Execute a command line command from the script file. It calls one of
   // the following specific command execution functions.
   void execute(Ris::CmdLineCmd* aCmd);

   // Execute specific commands.
   void executeInit(Ris::CmdLineCmd* aCmd);

   void executeStepHi(Ris::CmdLineCmd* aCmd);
   void executeStepLo(Ris::CmdLineCmd* aCmd);

   // Helper.
   void doSetOutputValue(bool aPulseFlag);
};

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Global singular instance.

#ifdef _PULSEGEN_CPP_
         PulseGen gPulseGen;
#else
extern   PulseGen gPulseGen;
#endif

//******************************************************************************
//******************************************************************************
//******************************************************************************

