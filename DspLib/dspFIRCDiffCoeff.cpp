/*==============================================================================
Description:
==============================================================================*/

//******************************************************************************
//******************************************************************************
//******************************************************************************

#include "stdafx.h"

#include "dsp_math.h"
#include "dsp_functions.h"

#include "dspFIRCDiffCoeff.h"

namespace Dsp
{

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Calculate coefficients.

void doCalcCoeffFirstDerivative_Holob(
   int aN,
   double aH,
   double* aC,
   double* aB)
{
   // Locals.
   double tH = aH;
   switch (aN)
   {
      case 3:
      {
         double tD = 2*aH;
         aC[0] = 0;
         aC[1] = 1/tD;
      }
      break;
      case 5:
      {
         double tD = 12*aH;
         aC[0] = 0;
         aC[1] = 8/tD;
         aC[2] = -1/tD;
      }
      break;
      case 7:
      {
         double tD = 60*aH;
         aC[0] = 0;
         aC[1] = 45/tD;
         aC[2] = -9/tD;
         aC[3] = 1/tD;
      }
      break;
      case 9:
      {
         double tD = 840*aH;
         aC[0] = 0;
         aC[1] = 672/tD;
         aC[2] = -168/tD;
         aC[3] = 32/tD;
         aC[4] = -3/tD;
      }
      break;
      default:
      {
         printf("doCalcCoeffFirstDerivative_Holob FAIL\n");
      }
   }

   int N = aN;
   int M = (N-1)/2;

   for (int k = 0; k <= M; k++)
   {
      aB[M + k] = -aC[k];
      aB[M - k] = aC[k];
   }
}

//******************************************************************************
//******************************************************************************
//******************************************************************************
}//namespace