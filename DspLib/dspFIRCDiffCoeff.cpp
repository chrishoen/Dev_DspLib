/*==============================================================================
Description:
==============================================================================*/

//******************************************************************************
//******************************************************************************
//******************************************************************************

#include "stdafx.h"

#include "dsp_math.h"
#include "dsp_functions.h"

#include "dspFIRCDiffCoeff.h"

namespace Dsp
{

//******************************************************************************
//******************************************************************************
//******************************************************************************
// Constructor.

void doCalcCoeffFirstDerivative_Holob(
   int aN,
   double aH,
   double* aC,
   double* aB)
{
   // Locals.
   double tH = aH;

   int N = aN;
   int M = (N-1)/2;
   int m = (N-3)/2;

   double tTerm1 = 1.0/pow(2.0,double(2*m+1));
   double tTerm2 = 1.0/tH;

   // Calculate the coefficients.
   aC[0] = 0.0;

   for (int k = 1; k <= M; k++)
   {
      aC[k] = tTerm1*tTerm2*(double(dsp_binomial(2*m,m-k+1) - dsp_binomial(2*m,m-k-1)));
   }
   
   for (int k = 0; k <= M; k++)
   {
      aB[M + k] = -k;
      aB[M - k] = k;

      aB[M + k] = -aC[k];
      aB[M - k] = aC[k];
   }

}

//******************************************************************************
//******************************************************************************
//******************************************************************************
}//namespace